---
import Layout from './Layout.astro';

export interface Props {
	frontmatter: {
		title?: string;
		date?: Date;
		[key: string]: any;
	};
}

const { frontmatter } = Astro.props;
const title = frontmatter.title || 'Copilot Workouts';
---

<Layout title={title}>
	<article class="max-w-none content-article px-4 md:px-8">
		<div class="content-background rounded-xl p-8 shadow-lg">
			<header class="content-header mb-12 pb-8">
				{frontmatter.title && (
					<h1 class="content-title text-4xl md:text-5xl font-bold mb-6 leading-tight">{frontmatter.title}</h1>
				)}
				{frontmatter.date && (
					<time class="content-date text-base" datetime={frontmatter.date.toISOString()}>
						{frontmatter.date.toLocaleDateString('en-US', { 
							year: 'numeric', 
							month: 'long', 
							day: 'numeric' 
						})}
					</time>
				)}
			</header>
			
			<div class="content-prose max-w-none">
				<slot />
			</div>
		</div>
	</article>
	
	<!-- Debug script -->
	<script>
		console.log('Theme attribute:', document.documentElement.getAttribute('data-theme'));
		console.log('Dark class present:', document.documentElement.classList.contains('dark'));
		console.log('Content prose element:', document.querySelector('.content-prose'));
	</script>
</Layout>

<style>
	/* Content layout specific styles with high specificity */
	.content-article {
		color: var(--color-text) !important;
	}
	
	/* Content background - gives the blog post a proper background */
	.content-background {
		background-color: var(--color-card) !important;
		border: 1px solid var(--color-border);
	}
	
	.content-header {
		border-bottom: 1px solid var(--color-border);
	}
	
	.content-title {
		color: var(--color-text) !important;
	}
	
	.content-date {
		color: var(--color-text-secondary) !important;
	}
	/* Custom prose styling that adapts to our space theme */
	.content-prose {
		color: var(--color-text) !important;
		max-width: none;
		font-family: 'Inter', system-ui, sans-serif;
		line-height: 1.8;
		font-size: 1.125rem;
		letter-spacing: 0.025em;
		padding: 2rem 0;
	}

	/* Headings with better spacing */
	.content-prose h1 {
		font-size: 2.5rem;
		font-weight: 700;
		line-height: 1.2;
		margin-top: 3rem;
		margin-bottom: 1.5rem;
		color: var(--color-text) !important;
		border-bottom: 2px solid var(--color-border);
		padding-bottom: 0.75rem;
		letter-spacing: -0.025em;
	}

	.content-prose h2 {
		font-size: 2rem;
		font-weight: 600;
		line-height: 1.3;
		margin-top: 2.5rem;
		margin-bottom: 1.25rem;
		color: var(--color-text) !important;
		border-bottom: 1px solid var(--color-border);
		padding-bottom: 0.5rem;
		letter-spacing: -0.025em;
	}

	.content-prose h3 {
		font-size: 1.625rem;
		font-weight: 600;
		line-height: 1.4;
		margin-top: 2rem;
		margin-bottom: 1rem;
		color: var(--color-text) !important;
		letter-spacing: -0.025em;
	}

	.content-prose h4 {
		font-size: 1.375rem;
		font-weight: 600;
		line-height: 1.4;
		margin-top: 1.75rem;
		margin-bottom: 0.75rem;
		color: var(--color-text) !important;
		letter-spacing: -0.025em;
	}

	.content-prose h5, .content-prose h6 {
		font-size: 1.25rem;
		font-weight: 500;
		line-height: 1.4;
		margin-top: 1.5rem;
		margin-bottom: 0.75rem;
		color: var(--color-text) !important;
		letter-spacing: -0.025em;
	}

	/* Paragraphs with generous spacing */
	.content-prose p {
		margin-top: 1.5rem;
		margin-bottom: 1.5rem;
		color: var(--color-text) !important;
		line-height: 1.8;
	}

	.content-prose strong {
		font-weight: 600;
		color: var(--color-text) !important;
	}

	.content-prose em {
		font-style: italic;
		color: var(--color-text) !important;
	}

	/* Links */
	.content-prose a {
		color: var(--color-accent);
		text-decoration: underline;
		text-decoration-color: var(--color-accent);
		text-underline-offset: 2px;
		transition: all 0.2s ease;
	}

	.content-prose a:hover {
		color: var(--color-accent-hover);
		text-decoration-color: var(--color-accent-hover);
	}

	/* Lists with better spacing */
	.content-prose ul, .content-prose ol {
		margin-top: 1.5rem;
		margin-bottom: 1.5rem;
		padding-left: 2rem;
		color: var(--color-text) !important;
	}

	.content-prose li {
		margin-top: 0.75rem;
		margin-bottom: 0.75rem;
		color: var(--color-text) !important;
		line-height: 1.7;
	}

	.content-prose li::marker {
		color: var(--color-text-secondary) !important;
	}

	/* Nested lists */
	.content-prose li > ul,
	.content-prose li > ol {
		margin-top: 0.75rem;
		margin-bottom: 0.75rem;
	}

	/* Blockquotes with enhanced spacing */
	.content-prose blockquote {
		border-left: 4px solid var(--color-accent);
		background-color: var(--color-bg-secondary);
		padding: 1.5rem 2rem;
		margin: 2rem 0;
		border-radius: 0.75rem;
		font-style: italic;
		color: var(--color-text-secondary) !important;
		font-size: 1.125rem;
		line-height: 1.7;
	}

	.content-prose blockquote p {
		margin: 1rem 0;
		color: var(--color-text-secondary) !important;
	}

	.content-prose blockquote p:first-child {
		margin-top: 0;
	}

	.content-prose blockquote p:last-child {
		margin-bottom: 0;
	}

	/* Code with better spacing and readability */
	.content-prose code {
		background-color: var(--color-bg-secondary);
		color: var(--color-text) !important;
		padding: 0.25rem 0.5rem;
		border-radius: 0.5rem;
		font-family: 'JetBrains Mono', 'Fira Code', monospace;
		font-size: 0.9em;
		border: 1px solid var(--color-border);
		letter-spacing: 0;
	}

	.content-prose pre {
		background-color: var(--color-bg-secondary);
		border: 1px solid var(--color-border);
		border-radius: 0.75rem;
		padding: 2rem;
		overflow-x: auto;
		margin: 2rem 0;
		font-family: 'JetBrains Mono', 'Fira Code', monospace;
		font-size: 0.9rem;
		line-height: 1.6;
	}

	.content-prose pre code {
		background: none;
		border: none;
		padding: 0;
		color: var(--color-text) !important;
		font-size: inherit;
	}

	/* Tables with improved spacing */
	.content-prose table {
		width: 100%;
		border-collapse: collapse;
		margin: 2rem 0;
		background-color: var(--color-card);
		border: 1px solid var(--color-border);
		border-radius: 0.75rem;
		overflow: hidden;
		font-size: 0.95rem;
	}

	.content-prose th, .content-prose td {
		padding: 1rem 1.25rem;
		text-align: left;
		border-bottom: 1px solid var(--color-border);
		color: var(--color-text) !important;
		line-height: 1.6;
	}

	.content-prose th {
		background-color: var(--color-bg-secondary);
		font-weight: 600;
		color: var(--color-text) !important;
	}

	.content-prose tr:last-child td {
		border-bottom: none;
	}

	.content-prose tr:nth-child(even) {
		background-color: var(--color-bg-secondary);
	}

	/* Horizontal rules with better spacing */
	.content-prose hr {
		border: none !important;
		height: 2px;
		background: linear-gradient(90deg, transparent, var(--color-border), transparent) !important;
		margin: 3rem 0 !important;
		padding: 0 !important;
		width: 100%;
		opacity: 0.6;
		border-radius: 1px;
	}

	/* Images with improved spacing */
	.content-prose img {
		max-width: 100%;
		height: auto;
		border-radius: 0.75rem;
		margin: 2rem auto;
		box-shadow: var(--shadow-md);
		display: block;
	}

	/* Task lists */
	.content-prose input[type="checkbox"] {
		margin-right: 0.75rem;
		accent-color: var(--color-accent);
	}

	/* Enhanced spacing after headings */
	.content-prose h1 + p,
	.content-prose h2 + p,
	.content-prose h3 + p,
	.content-prose h4 + p,
	.content-prose h5 + p,
	.content-prose h6 + p {
		margin-top: 0.75rem;
	}

	/* Better spacing for first and last elements */
	.content-prose > *:first-child {
		margin-top: 0;
	}

	.content-prose > *:last-child {
		margin-bottom: 0;
	}

	/* Override any remaining Tailwind text colors */
	.content-prose * {
		color: inherit !important;
	}

	/* Ensure all direct children of content-prose have proper color */
	.content-prose > * {
		color: var(--color-text) !important;
	}
	
	
	/* Keep links with accent colors */
	.content-prose a {
		color: var(--color-accent) !important;
	}

	/* Add breathing room for content sections */
	.content-prose > h2,
	.content-prose > h3,
	.content-prose > h4 {
		scroll-margin-top: 2rem;
	}

	/* Enhanced readability for links within content */
	.content-prose a {
		color: var(--color-accent) !important;
		text-decoration: underline;
		text-decoration-color: var(--color-accent);
		text-underline-offset: 3px;
		text-decoration-thickness: 1px;
		transition: all 0.2s ease;
	}

	.content-prose a:hover {
		color: var(--color-accent-hover) !important;
		text-decoration-color: var(--color-accent-hover);
		text-decoration-thickness: 2px;
	}
	
	/* FINAL FIX: Explicit color overrides for maximum readability */
	html:not([data-theme="dark"]) .content-prose,
	html:not([data-theme="dark"]) .content-prose *:not(a),
	html:not([data-theme="dark"]) .content-prose p,
	html:not([data-theme="dark"]) .content-prose h1,
	html:not([data-theme="dark"]) .content-prose h2,
	html:not([data-theme="dark"]) .content-prose h3,
	html:not([data-theme="dark"]) .content-prose h4,
	html:not([data-theme="dark"]) .content-prose h5,
	html:not([data-theme="dark"]) .content-prose h6,
	html:not([data-theme="dark"]) .content-prose li,
	html:not([data-theme="dark"]) .content-prose ul,
	html:not([data-theme="dark"]) .content-prose ol,
	html:not([data-theme="dark"]) .content-prose div,
	html:not([data-theme="dark"]) .content-prose span,
	html:not([data-theme="dark"]) .content-prose strong,
	html:not([data-theme="dark"]) .content-prose em {
		color: #1e293b !important;
	}
	
	html[data-theme="dark"] .content-prose,
	html[data-theme="dark"] .content-prose *:not(a),
	html[data-theme="dark"] .content-prose p,
	html[data-theme="dark"] .content-prose h1,
	html[data-theme="dark"] .content-prose h2,
	html[data-theme="dark"] .content-prose h3,
	html[data-theme="dark"] .content-prose h4,
	html[data-theme="dark"] .content-prose h5,
	html[data-theme="dark"] .content-prose h6,
	html[data-theme="dark"] .content-prose li,
	html[data-theme="dark"] .content-prose ul,
	html[data-theme="dark"] .content-prose ol,
	html[data-theme="dark"] .content-prose div,
	html[data-theme="dark"] .content-prose span,
	html[data-theme="dark"] .content-prose strong,
	html[data-theme="dark"] .content-prose em {
		color: #f1f5f9 !important;
	}
</style>